# MNIST GAN с остаточными блоками

Этот проект демонстрирует реализацию Генеративно-состязательной сети (GAN) для генерации изображений цифр, похожих на MNIST. Генератор использует остаточные блоки для улучшения качества генерации изображений, а слои dropout применяются как в генераторе, так и в дискриминаторе для увеличения разнообразия и снижения переобучения.

## Структура проекта

- `modeling.ipynb`: Jupyter Notebook, содержащий обучение и проверку модели.
- `models/modules.py`: Содержит архитектуру генератора и дискриминатора, а также класс тренера.
- `models/models.pth`: Хранит веса моделей.
- `data`: В эту папку загружается датасет.

## Возможности

- **Генератор**:
  - Использует остаточные блоки для улучшения качества генерации.
  - Dropout-слои улучшают обобщение и добавляют случайность.
  - Выводит изображения размером 28x28 (размер MNIST).

- **Дискриминатор**:
  - Использует сверточные слои с dropout для регуляризации.
  - Применяет активации Leaky ReLU для стабильного обучения.

### Датасет

Проект использует датасет MNIST, который автоматически загружается через `torchvision.datasets`.

## Архитектура модели

### Генератор

- Линейный слой для проекции шума и меток в начальную карту признаков.
- Остаточный блок для улучшения признаков.
- Слои увеличения разрешения для генерации изображений 28x28.
- Dropout для увеличения разнообразия.

### Дискриминатор

- Сверточные слои для извлечения признаков.
- Полносвязные слои для бинарной классификации.
- Dropout для регуляризации.

## Пример использования

### Генерация изображений

После обучения GAN можно использовать генератор для создания изображений, похожих на MNIST:

```python
import torch as t
from torch.nn import functional as f
from models.modules import Discriminator, Generator

# Загрузка обученного генератора
generator = Generator()
generator.load_state_dict(t.load('models/models.pth')['Generator'])
generator.eval()

# Генерация случайного шума и условных меток
noise = t.randn(10, 246)  # Случайный шум
labels = t.randint(0, 10, (10,))  # Случайные метки MNIST
one_hot = f.one_hot(labels, num_classes=10)
input_vector = t.cat([one_hot, noise], dim=-1)

# Генерация изображений
images = generator(input_vector)
```

### Оценка дискриминатора

Чтобы протестировать дискриминатор:

```python
# Загрузка обученного дискриминатора
discriminator = Discriminator()
discriminator.load_state_dict(torch.load('models/models.pth')['Discriminator'])
discriminator.eval()

# Оценка реальных или сгенерированных изображений
output = discriminator(images)
```

## Результаты

Генератор создает реалистичные изображения, похожие на MNIST, а дискриминатор эффективно отличает реальные образцы от сгенерированных. При правильной настройке GAN достигает высокого качества генерации изображений.
